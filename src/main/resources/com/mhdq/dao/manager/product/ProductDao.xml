<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mhdq.dao.manager.product.ProductDao">
	<resultMap type="com.manager.product.dto.ProductDTO" id="BaseResultMap">
		<id column="id" property="id" jdbcType="BIGINT"/>
		<result column="prod_id" property="prodId" jdbcType="VARCHAR" />
        <result column="code_id" property="codeId"  />
        <result column="prod_name" property="prodName"  />
        <result column="prod_detail" property="prodDetail" />
        <result column="prod_type_name" property="prodTypeName" />
        <result column="prod_prize" property="prodPrize" />
        <result column="prod_free_time" property="prodFreeTime" />
        <result column="prod_sum" property="prodSum" />
        <result column="prod_sell_sum" property="prodSellSum" />
        <result column="status" property="status" />
        <result column="create_time" property="createTime" />
	</resultMap>
	
	<sql id="Base_Column_List">
		id,prod_id,code_id,prod_name,prod_detail,prod_type_name,
		prod_prize,prod_free_time,prod_sum,prod_sell_sum,status,create_time
	</sql>
	
	<select id="selectByPrimaryKey" parameterType="java.lang.Long" resultMap="BaseResultMap">
		select <include refid="Base_Column_List"/>
		from t_product
		where id = #{id}
	</select>
	
	<insert id="insert">
		insert into t_product (
		<include refid="Base_Column_List"></include>
		) values (
			#{id,jdbcType=BIGINT},#{prodId, jdbcType=VARCHAR},#{codeId,jdbcType=VARCHAR},
			#{prodName,jdbcType=VARCHAR},#{prodDetail,jdbcType=VARCHAR},#{prodTypeName,jdbcType=VARCHAR},
			#{prodPrize,jdbcType=DECIMAL},#{prodFreeTime,jdbcType=VARCHAR},#{prodSum,jdbcType=INTEGER},
			#{prodSellSum,jdbcType=INTEGER},#{status,jdbcType=TINYINT},now()
		)
	</insert>
	
	<select id="dataGrid" parameterType="page" resultMap="BaseResultMap">
		select <include refid="Base_Column_List" />
		from t_product where 1=1
		<if test="params.prodName != null and params.prodName != ''">
			and prod_name LIKE concat('%',#{params.prodName},'%') 
		</if>
		<if test="params.codeId != null and params.codeId != ''">
			and code_id LIKE concat('%',#{params.codeId},'%') 
		</if>
	</select>
	
	<delete id="deleteByProductId" parameterType="java.lang.String">
		delete from t_product where prod_id = #{prodId}
	</delete>
	
	<update id="update" parameterType="com.manager.product.dto.ProductDTO">
		update t_product
		<set>
			<if test="prodName != null and prodName != ''">
				prod_name = #{prodName},
			</if>
			<if test="codeId != null and codeId != ''">
				code_id = #{codeId},
			</if>
			<if test="prodDetail != null and prodDetail != ''">
				prod_detail = #{prodDetail},
			</if>
			<if test="prodTypeName != null and prodTypeName != ''">
				prod_type_name = #{prodTypeName},
			</if>
			<if test=" prodPrize != null">
				 prod_prize = #{prodPrize},
			</if>
			<if test="prodFreeTime != null and prodFreeTime != ''">
				prod_free_time = #{prodFreeTime},
			</if>
			<if test="prodSum != null">
				prod_sum = #{prodSum},
			</if>
		</set>
		where prod_id = #{prodId}
	</update>
	
	<update id = "updateProductStatus" parameterType="java.lang.String">
	 	update t_product 
	 	set status = 1
	 	where prod_id = #{prodId}
	</update>
	
</mapper>